import Head from "next/head";
import Image from "next/image";
import React from "react";
import images from "constants/images";

export default function index() {
    React.useEffect(() => {
        window.map = null;
        ymaps3.ready.then(init);

        const {
            YMap,
            YMapDefaultSchemeLayer,
            YMapControls,
            YMapDefaultFeaturesLayer,
            YMapMarker,
            geolocation,
        } = ymaps3;
        async function init() {
            var location = geolocation.getPosition();
            var coords;
            location.then(function (res) {
                console.log(res.coords);
                coords = res.coords;
            });
            const { YMapGeolocationControl } = await ymaps3.import(
                "@yandex/ymaps3-controls@0.0.1"
            );
            const { YMapZoomControl } = await ymaps3.import(
                "@yandex/ymaps3-controls@0.0.1"
            );

            map = new YMap(document.getElementById("map"), {
                location: {
                    center: coords === undefined ? [37.64, 55.76] : coords,
                    zoom: 16,
                },
            });
            map.addChild(new YMapDefaultSchemeLayer());
            map.addChild(new YMapDefaultFeaturesLayer());
            map.addChild(
                new YMapControls({ position: "right" }).addChild(
                    new YMapZoomControl({})
                )
            );
            map.addChild(
                new YMapControls({ position: "bottom right" }).addChild(
                    new YMapGeolocationControl({})
                )
            );

            // let lol = geolocation.getPosition;
            // lol.then(function (result) {
            //     console.log(result);
            // });

            // console.log(new YMapGeolocationControl;
            const el = document.createElement("img");
            el.className = "myMarker";
            el.src = "./pin.svg";
            map.addChild(new YMapMarker({ coordinates: [37.64, 55.76] }, el));
        }
    }, []);
    return (
        <>
            <Head>
                <title>MY SPOT | SPOTS</title>
                <meta
                    name="description"
                    content="Generated by create next app"
                />
                <meta property="og:title" content="MY SPOT" key="title" />
            </Head>
            <div id="map" style={{ width: "100vw", height: "100vh" }}></div>
        </>
    );
}
